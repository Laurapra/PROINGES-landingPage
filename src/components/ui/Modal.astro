---
interface Props {
  id: string;
  title: string;
}

const { id, title } = Astro.props;
---

<div 
  id={id} 
  class="modal fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] hidden items-center justify-center p-4"
  aria-hidden="true"
>
  <div 
    class="modal-content bg-white dark:bg-[#0c181d] rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col border border-slate-200 dark:border-white/10"
    role="dialog"
    aria-modal="true"
    aria-labelledby={`${id}-title`}
  >
    <!-- Header -->
    <div class="flex items-center justify-between p-6 border-b border-slate-200 dark:border-white/10">
      <h2 
        id={`${id}-title`}
        class="text-2xl font-bold text-secondary dark:text-white"
      >
        {title}
      </h2>
      <button 
        class="modal-close text-slate-400 hover:text-slate-600 dark:hover:text-white transition-colors p-2"
        aria-label="Cerrar modal"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>

    <!-- Content -->
    <div class="overflow-y-auto p-6 modal-prose">
      <slot />
    </div>

    <!-- Footer -->
    <div class="flex justify-end gap-4 p-6 border-t border-slate-200 dark:border-white/10 bg-slate-50 dark:bg-white/5">
      <button 
        class="modal-close px-6 py-2 rounded-lg font-medium text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-white/10 transition-colors"
      >
        Cerrar
      </button>
    </div>
  </div>
</div>

<script>
  function setupModal(modalId: string) {
    const modal = document.getElementById(modalId);
    const closeButtons = modal?.querySelectorAll('.modal-close');
    
    // Función para abrir modal
    const openModal = () => {
      modal?.classList.remove('hidden');
      modal?.classList.add('flex');
      document.body.style.overflow = 'hidden';
    };
    
    // Función para cerrar modal
    const closeModal = () => {
      modal?.classList.add('hidden');
      modal?.classList.remove('flex');
      document.body.style.overflow = '';
    };
    
    // Cerrar al hacer clic en los botones de cerrar
    closeButtons?.forEach(button => {
      button.addEventListener('click', closeModal);
    });
    
    // Cerrar al hacer clic fuera del modal
    modal?.addEventListener('click', (e) => {
      if (e.target === modal) {
        closeModal();
      }
    });
    
    // Cerrar con ESC
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && !modal?.classList.contains('hidden')) {
        closeModal();
      }
    });
    
    return { openModal, closeModal };
  }
  
  // Inicializar modales
  setupModal('privacy-modal');
  setupModal('terms-modal');
</script>

<style>
  .modal {
    animation: fadeIn 0.2s ease-out;
  }
  
  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }
  
  .modal-content {
    animation: slideUp 0.3s ease-out;
  }
  
  @keyframes slideUp {
    from {
      transform: translateY(20px);
      opacity: 0;
    }
    to {
      transform: translateY(0);
      opacity: 1;
    }
  }

  /* Estilos mejorados para el contenido del modal */
  .modal-prose {
    @apply text-slate-700 dark:text-slate-300;
  }
  
  .modal-prose h3 {
    @apply text-xl font-bold text-secondary dark:text-white mt-6 mb-3;
  }
  
  .modal-prose h4 {
    @apply text-lg font-bold text-secondary dark:text-white mt-4 mb-2;
  }
  
  .modal-prose p {
    @apply text-slate-600 dark:text-slate-400 mb-4 leading-relaxed;
  }
  
  .modal-prose ul {
    @apply text-slate-600 dark:text-slate-400 space-y-2 mb-4 list-disc;
  }
  
  .modal-prose li {
    @apply ml-6 text-slate-600 dark:text-slate-400;
  }
  
  .modal-prose strong {
    @apply text-secondary dark:text-white font-semibold;
  }

  .modal-prose a {
    @apply text-primary hover:text-accent dark:text-primary dark:hover:text-sky-400 underline;
  }

  /* Scrollbar personalizado para el contenido */
  .modal-prose::-webkit-scrollbar {
    width: 8px;
  }

  .modal-prose::-webkit-scrollbar-track {
    @apply bg-slate-100 dark:bg-white/5 rounded;
  }

  .modal-prose::-webkit-scrollbar-thumb {
    @apply bg-slate-300 dark:bg-white/20 rounded hover:bg-slate-400 dark:hover:bg-white/30;
  }
</style>